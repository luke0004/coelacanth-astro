---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths({ paginate }) {
  const posts = (await getCollection('logbook')).sort(
    (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
  );
  return paginate(posts, { pageSize: 10 });
}

const { page } = Astro.props;
---

<BaseLayout title="Coelacanth">
  <h2>Logbook</h2>
  {page.data.map(post => (
    <p>
      <small>{post.data.date.toLocaleDateString('en-GB')}</small><br />
      <b><a href={`/logbook/${post.slug}/`}>{post.data.title}</a></b>
      <br />
      {post.data.description}
      <br /><br />
    </p>
  ))}

  {(page.url.prev || page.url.next) && (
    <nav class="pagination">
      {page.url.prev ? (
        <a href={page.url.prev}>← Newer</a>
      ) : (
        <span></span>
      )}
      <span class="page-info">Page {page.currentPage} of {page.lastPage}</span>
      {page.url.next ? (
        <a href={page.url.next}>Older →</a>
      ) : (
        <span></span>
      )}
    </nav>
  )}
</BaseLayout>
